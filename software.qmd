---
title: "Lab Software"
subtitle: "High-performance tools for microbiome bioinformatics and virology."
listing:
  contents: software.yml
  type: grid
  sort: "stars desc"
  grid-columns: 3
  image-height: 150px
  fields: [title, description, stars]
  field-display-names:
    stars: "GitHub Stars"
---

```{r}
#| include: false
#| echo: false

library(gh)
library(yaml)
library(purrr)

# 1. Fetch all public repos for the CMMR organization
repos <- gh("/orgs/cmmr/repos", type = "public", .limit = 100)

# 2. Extract and format the data
software_data <- map(repos, ~{
  list(
    title = .x$name,
    description = .x$description %||% "No description provided.",
    path = .x$html_url,
    stars = .x$stargazers_count,
    # Assign custom images if they exist, else use a lab placeholder
    image = sprintf("[https://raw.githubusercontent.com/cmmr/%s/main/man/figures/logo.png](https://raw.githubusercontent.com/cmmr/%s/main/man/figures/logo.png)", .x$name)
  )
})

# 3. Sort by stars descending
software_data <- software_data[order(map_dbl(software_data, "stars"), decreasing = TRUE)]

# 4. Write to software.yml for the Quarto listing to read
write_yaml(software_data, "software.yml")
```
